"use strict";(self.webpackChunkorderpls=self.webpackChunkorderpls||[]).push([[806],{9806:(e,t,a)=>{a.r(t),a.d(t,{OPCasherBilling:()=>h});var n=a(5043),l=a(5042),r=a(8831),s=a(4301),c=a(8136),i=a(6604),u=a(2104),d=a(3003),o=a(579);const h=()=>{const[e,t]=(0,n.useState)(!1),[a,h]=(0,n.useState)(!1),[b,m]=(0,n.useState)(!0),[_,v]=(0,n.useState)(!1),[x,p]=(0,n.useState)(!1),g=(0,n.useRef)([]),f=(0,n.useRef)({}),j=(0,n.useRef)([]),y=(0,n.useRef)([]),w=(0,n.useRef)([]),N=(0,n.useRef)(null),k=(0,n.useRef)(null),B=((0,l.i)(),(0,d.d4)((e=>e.appstate.login_info)));function C(e){w.current=e.menuList;g.current=[{arrayindex:0,csstheme:{labletext:"",classname:"btn-close custom-btn-close border p-1 me-0 d-flex align-items-center justify-content-center rounded-circle",id:"btn_cross",icon:"ti ti-x"}},{arrayindex:1,csstheme:{labletext:"Get Payment",classname:"btn btn-primary",id:"btn_finish"}},{arrayindex:2,csstheme:{labletext:"Cancel",classname:"btn btn-light me-2",id:"btn_cancel"}}],function(e){y.current=e;let t={groupbtnname:"beanchlst",groupbtnselectedname:null,groupbtndata:e.filter((e=>"payment"==e.status))};f.current=t}(e.hotelBench),function(){let e={tablename:"tbl_orderlist",grpbtnrowid:null,grpbtnindex:null,tableindex:null,actionButton:{hasAction:!0,hasStatus:!0,canEditRow:!0,canDeleteRow:!0},tableMetaData:{showPagination:!1,showSearch:!1},colMetaData:[{h_colindex:0,h_name:"Orders",h_width:"200px",h_txtalign:"left",h_navigate:"/home"},{h_colindex:1,h_name:"Qty",h_width:"100px",h_txtalign:"left",h_navigate:"/home"},{h_colindex:2,h_name:"Sub total",h_width:"100px",h_txtalign:"left",h_navigate:"/home"},{h_colindex:3,h_name:"Total",h_width:"100px",h_txtalign:"left",h_navigate:"/home"}],tableData:[]};j.current=e}(),h(!0),m(!1)}function D(a){switch(a.currentTarget.id){case"btn_cross":case"blurdiv":case"btn_cancel":document.body.style="",N.current=null,v(!1);break;case"btn_finish":!function(){const a=j.current.grpbtnrowid,n=j.current.grpbtnindex,l=j.current.tableData.map((e=>({showrow:e.showrow,table_value:[{t_key:0,t_value:e.l_table_value[0].t_value},{t_key:1,t_value:e.l_table_value[1].t_value},{t_key:2,t_value:e.l_table_value[2].t_value},{t_key:3,t_value:"Waiting"}]})));console.log(l),f.current.groupbtndata.splice(n,1),k.current.emit("updateCasherBilling",a,l),document.body.style="",v(!1),t(!e)}()}}return(0,n.useEffect)((()=>(k.current=(0,u.io)("https://canteen-billing-1.onrender.com"),k.current.emit("joinCasherBilling",B._id),k.current.on("sendCasherBilling",(e=>{C(e)})),k.current.on("documentUpdated",((e,t,a)=>{const n=f.current.groupbtndata.findIndex((t=>t._id===e));-1==n?t.ispayment||(f.current.groupbtndata.push(t),p((e=>!e))):(f.current.groupbtndata.splice(n,1),p((e=>!e)))})),()=>{k.current&&k.current.disconnect()})),[e]),(0,o.jsxs)(o.Fragment,{children:[b&&(0,o.jsx)(r.z,{}),a&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"page-wrapper",children:(0,o.jsx)("div",{className:"content",children:(0,o.jsx)("div",{className:"row",children:(0,o.jsxs)("div",{className:"col-md-12",children:[(0,o.jsx)("div",{className:"page-header",children:(0,o.jsxs)("div",{className:"row align-items-center",children:[(0,o.jsx)("div",{className:"col-sm-4",children:(0,o.jsx)("h4",{className:"page-title",children:"Order waiting for payment"})}),(0,o.jsx)("div",{className:"col-sm-8 text-sm-end",children:(0,o.jsx)("div",{className:"head-icons"})})]})}),(0,o.jsx)("div",{className:"row",children:(0,o.jsx)("div",{className:"col-lg-12",children:(0,o.jsx)("div",{className:"card",children:(0,o.jsxs)("div",{className:"card-body",id:"card-body",children:[(0,o.jsxs)("div",{className:"border-bottom mb-3 pb-3",children:[(0,o.jsx)("h5",{className:"fw-semibold mb-1",children:"Order's"}),(0,o.jsx)("p",{children:"Your order is ready. Please proceed to payment."})]}),(0,o.jsx)(s.z,{groupBtnName:f.current.groupbtnname,groupBtnData:f.current.groupbtndata,handleGroupButtonClick:function(e,t){if("beanchlst"===e){document.body.style.overflow="hidden",console.log(w.current);const e=structuredClone(f.current.groupbtndata[t].btn_values).map((e=>{const t=w.current.filter((t=>t.menuItem===e.table_value[0].t_value));return N.current+=Number(e.table_value[1].t_value)*t[0].price,{showrow:!0,l_table_value:[{t_key:0,t_value:e.table_value[0].t_value},{t_key:1,t_value:e.table_value[1].t_value},{t_key:2,t_value:e.table_value[2].t_value},{t_key:3,t_value:e.table_value[3].t_value}],table_value:[{t_key:0,t_value:e.table_value[0].t_value},{t_key:1,t_value:e.table_value[1].t_value},{t_key:2,t_value:t[0].price},{t_key:3,t_value:Number(e.table_value[1].t_value)*t[0].price}]}}));f.current.groupbtnselectedname=f.current.groupbtndata[t].studentName,j.current.grpbtnrowid=f.current.groupbtndata[t]._id,j.current.grpbtnindex=t,j.current.tableData=e,console.log(N.current)}v(!0)}})]})})})})]})})})}),(0,o.jsx)("div",{className:"offcanvas offcanvas-end offcanvas-large "+(_?"show":"hiding"),children:_&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"offcanvas-header border-bottom",children:[(0,o.jsx)("h4",{children:f.current.groupbtnselectedname}),(0,o.jsx)(c.G,{ctl_Attribute:g.current[0],handleButtonClick:D})]}),(0,o.jsxs)("div",{className:"offcanvas-body",children:[(0,o.jsx)("h4",{children:"Order"}),(0,o.jsx)(i.a,{tablename:j.current.tablename,actionButton:j.current.actionButton,tableMetaData:j.current.tableMetaData,colMetaData:j.current.colMetaData,tableData:j.current.tableData,handleTableActionClick:function(e,t,a,n){e}}),(0,o.jsx)("div",{className:"mt-2 d-flex",children:(0,o.jsxs)("h6",{style:{marginLeft:"27rem"},children:[(0,o.jsx)("span",{style:{marginLeft:"2rem"},children:"GST@ 18%  \xa0 :\xa0 "}),(N.current/18).toFixed(2)]})}),(0,o.jsx)("div",{className:"d-flex",children:(0,o.jsxs)("h3",{style:{marginLeft:"27rem"},children:[(0,o.jsx)("span",{style:{marginLeft:"2rem"},children:"Total \xa0 : "}),(N.current/18+N.current).toFixed(2)]})}),(0,o.jsxs)("div",{className:"mt-4 d-flex justify-content-end",children:[(0,o.jsx)(c.G,{ctl_Attribute:g.current[2],handleButtonClick:D}),(0,o.jsx)(c.G,{ctl_Attribute:g.current[1],handleButtonClick:D})]})]})]})}),_&&(0,o.jsx)("div",{className:"offcanvas-backdrop fade show",id:"blurdiv",onClick:D})]})]})}}}]);
//# sourceMappingURL=806.45dbd251.chunk.js.map